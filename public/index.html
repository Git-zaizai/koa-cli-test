<!DOCTYPE html>
<html lang="cn">
<head>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Document</title>
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        .div-style {
            border: 1px solid #dad8d8;
            padding: 20px;
            margin: 5px 0;
        }

    </style>
</head>
<body>
<div class="div-style">
    <input type="file" id="file">
    <button>上传</button>
    <div class="imgs"></div>
</div>
<div class="div-style">
    zh：<input class="to-zh" type="text" value="123"/>
    mm：<input class="to-mm" type="text" value="123"/>
    &emsp;&emsp;
    <button class="to-but">创建token</button>
    &emsp;&emsp;
    <button class="to-vsbut">解密token</button>
    <div class="to-so">
        <span>token：</span>
        <p></p>
    </div>
    <div class="to-vs">
        <span>解密token：</span>
        <p></p>
    </div>
</div>
</body>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script>
    let files = null;
    document.querySelector('#file').addEventListener('change', function () {
        console.log('asdkjhaslkdahskd')
        files = this.files
        var dataURL = URL.createObjectURL(files[0])
        var img = document.createElement('img')
        img.src = dataURL
        img.style.height = '300px'
        img.style.width = '300px'
        document.querySelector('.imgs').appendChild(img)
    })
    document.querySelector('button').onclick = function () {
        const fromd = new FormData()
        fromd.append('files', files[0])
        axios({
            method: 'post',
            url: 'http://localhost:4370/web/upload',
            data: fromd,
            responseType: 'json'
        }).then(res => {
            console.log(res)
        }).catch(err => {
            console.log('请求错误', err)
        })
    }
</script>
<script>
    let token = ''
    document.querySelector('.to-but').onclick = function () {
        axios({
            method: 'post',
            url: '/web/jwt',
            data: {

                zh: document.querySelector('.to-zh').value,
                mm: document.querySelector('.to-mm').value
            },
            responseType: 'json'
        }).then(res => {
            console.log(res)
            document.querySelector('.to-so').querySelector('p').innerHTML = res.data.token
            token = res.data.token
        })
    }

    document.querySelector('.to-vsbut').onclick = function () {
        if (token == '' || !token) {
            alert('请先创建token')
            return;
        }
        axios.post('/web/jwt/Verify', {token}, {responseType: 'json'}).then(res => {
            console.log('解密token：', res)
            document.querySelector('.to-vs').querySelector('p').innerHTML = JSON.stringify(res.data)
        })
    }
</script>
</html>
